
public class Main {
    //TC O(N)
    //SC O(N)
    public static String next_lexicographical_sequence(String s) {
        // Write your code here
        int pivot = s.length() - 2;
        char letters[] = s.toCharArray();
        while(pivot >= 0) {
            if(letters[pivot] >= letters[pivot+1])
            --pivot;
            else
            break;
        }
        //reverse the string
        if(pivot == -1) {
            StringBuilder sb = new StringBuilder(s);
            return sb.reverse().toString();
        }
        int rightMostSuccessor = s.length()-1;
        while(letters[rightMostSuccessor] <= letters[pivot]) {
            --rightMostSuccessor;
        }
        // swap now 
        char temp = letters[pivot];
        letters[pivot] = letters[rightMostSuccessor];
        letters[rightMostSuccessor] = temp;
        
        //now reverse after pivot 
        reverse(letters,pivot+1);

        return new String(letters);
    }
    public static void reverse(char letters[],int start) {
        int left = start, right = letters.length-1;

        while(left < right) {
            char temp = letters[left];
            letters[left] = letters[right];
            letters[right] = temp;
            left++;
            right--;
        }

    }
}
